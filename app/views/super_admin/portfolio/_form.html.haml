%div.col-md-12
  .row
    .form-group
      %label.font-size18 Thumbnail
      .col-md-12
        = f.fields_for :thumbnail do |t|
          = t.file_field :file
          = image_tag t.object.file.url || '', width: '123px', class: 'portfolio_thumbnail_preview'

    .form-group
      = f.label :category, class: 'font-size18'
      = f.select :category, Portfolio.category_collection, { include_blank: 'Select Category' }, required: true, class: 'form-control'
    - iklass = 'hidden' if f.object.video?
    .form-group.images_wrapper{class: iklass}
      %label.font-size18 Images
      .col-md-12
        %ul.list-group#images
          = f.fields_for :images do |ff|
            %li.list-group-item.display-inline
              = render 'image_fields', f: ff
      .col-md-12
        .col-md-3.cs_image_card
          = link_to_add_association '+', f, :images
    - vklass = 'hidden' unless f.object.video?
    .form-group.video_embed_code_wrapper{class: vklass}
      %label.font-size18 Video Embed Code
      = f.text_area :video_embed_code, class: 'form-control login', rows: 3
    .form-group
      = f.label :tier, class: 'font-size18'
      = f.select :tier, Portfolio.tiers.keys, { include_blank: 'Select Tier' }, required: true, class: 'form-control'
    .form-group
      = f.label :draft, class: 'font-size18 mr-sm'
      = f.check_box :draft
    .form-group
      = f.submit "Save Portfolio", class: 'btn btn-warning saveBtn'

:javascript
  $('#portfolio_image_attributes_file').change(function(event){
    var input = $(event.currentTarget);
    var file = input[0].files[0];
    var reader = new FileReader();
    reader.onload = function(e){
       image_base64 = e.target.result;
       $(".portfolio_image_preview").attr("src", image_base64);
    };
    reader.readAsDataURL(file);
  });
  $('#portfolio_thumbnail_attributes_file').change(function(event){
    var input = $(event.currentTarget);
    var file = input[0].files[0];
    var reader = new FileReader();
    reader.onload = function(e){
       image_base64 = e.target.result;
       $(".portfolio_thumbnail_preview").attr("src", image_base64);
    };
    reader.readAsDataURL(file);
  });

  $('#portfolio_category').change(function(){
    if($(this).val() == 'video'){
      $('.images_wrapper').addClass('hidden')
      $('.video_embed_code_wrapper').removeClass('hidden')
    }else{
      $('.images_wrapper').removeClass('hidden')
      $('.video_embed_code_wrapper').addClass('hidden')
    }
  })
