.page__main
  %section.agreement_section
    .container.mb-xxl.pb-xxl
      .row
        %div
          = form_tag agency_addendums_path, id: 'addendum_form', method: :post, remote: true do
            = hidden_field_tag 'addendum[agency_name]', @agency.name
            %h3.txt-cntr.ptb-25 Addendum A
            %p.text-doc.txt-jstfy
              %span This Addendum is issued pursuant to and incorporates the terms and conditions set forth in the White Label Agreement (“Agreement”) which was effective on
              %span
                = Time.current.day.ordinalize
              %span day of
              %span
                = Time.current.strftime('%B')
              %span #{Date.current.year}, entered into between Clickxposure LLC d/b/a Clickx (“Company”) and
              %span= text_field_tag 'current_user_name', current_user.name, required: true
              %span (“Label”).
              %br
              %br
              %span
                This Addendum modifies only the terms below. All other terms of the Agreement remain in full force and effect.
              %br
              %br
              %p
                %b 9.7 Video/Audio Recording.
                Label acknowledges and agrees to Company’s audio and/or video recording of conversations between the Parties to this Agreement. In the event Company desires to sue any such recording or portion thereof for marketing, publication, or other commercial use, Company shall seek Label’s express written consent. Label shall not be entitled to any royalty or other such compensation as a result of Company’s use of any recording.
              %br
              %p
                %b 10.3
                Company shall not be liable for the acts or omissions of any third party listed on Company’s website who Label hires for the provision of digital marketing services. For the avoidance of doubt, any third party who performs services for Label in connection with this Agreement is solely liable for its acts or omissions.
              %br
              %span IN WITNESS WHEREOF,
              &nbsp;&nbsp; the Parties, intending to be legally bound, have each executed this agreement as of the Effective Date.
              %br
              %br
              %p
                %b= current_user.name
            .col-md-6
              .form-group
                %label Name
                = text_field_tag 'addendum[name]', nil, class: 'form-control', required: true
                %span
                  = "Representative, #{@agency.name}"
              .form-group
                %label Title
                = text_field_tag 'addendum[title]', nil, class: 'form-control', required: true
              %p
                %span
                  = "Date&nbsp;&nbsp;&nbsp;&nbsp;#{Date.current.strftime('%d, %B %Y')}".html_safe
            .col-md-6
              .form-group
                .col-md-12
                  %label.pull-right Signature
                .col-md-12
                  = hidden_field_tag 'addendum[signature]', nil, class: 'form-control'
                  .pull-right
                    %canvas.form-control-lg.controls{height: '100', width: '300'}
                    %br
                    %a.clear_signature.pull-right.small.text-info{href: 'javascript:void(0)'}
                      Clear
                      %i.fa.fa-eraser{"aria-hidden" => "true"}


              .col-md-12
                = submit_tag 'Submit', class: 'btn btn-warning btn-lg btn-raised pull-right addendum_submit mt-xxl'
:javascript
  var canvas = document.querySelector("canvas");
  var signaturePad = new SignaturePad(canvas);
  signaturePad.onEnd = function(){
    $('#addendum_signature').val(signaturePad.toDataURL());
    $('.addendum_submit').removeClass('hidden')
  };
  $('.addendum_submit').on('click', function(e){
    e.preventDefault();
    if(signaturePad.isEmpty() == true){
      toastr.error('Signature is required.')
    }else{
      $('#addendum_form').submit()
    }
  });

  $('.clear_signature').on('click', function(e){
    signaturePad.clear();
  });
  $('#current_user_name').on('change', function(e){
    $('#addendum_name').val($(this).val());
  });
  $('#addendum_name').on('change', function(e){
    $('#current_user_name').val($(this).val());
  });
